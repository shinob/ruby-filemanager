# File Manager プロンプト

このプロンプトを使って、file_manager.rbと同等の機能を持つWebベースファイルマネージャーを0から生成できます。

## 基本プロンプト

```
Rubyの標準ライブラリのみを使用してWebベースファイルマネージャーを作成してください。以下の仕様を満たしてください：

## 基本機能
1. HTTPサーバー機能（TCPServerを使用）
2. ディレクトリとファイルの一覧表示
3. ファイルのアップロード（multipart/form-data対応）
4. ファイル・ディレクトリの削除
5. ファイル・ディレクトリの名前変更
6. ファイルのダウンロード

## 表示・UI機能
7. レスポンシブなHTML生成
8. 画像ファイルのモーダルプレビュー機能
9. テキストファイルビューア（エンコーディング選択可能）
10. 動画ファイルビューア（HTML5 video対応）
11. ファイル種別ごとのアイコン表示（📁📄📷🎬）
12. 親ディレクトリへの戻るリンク

## 技術仕様
13. マルチスレッド対応（Thread.new使用）
14. HTTP Range Request対応（動画ストリーミング用）
15. 適切なMIMEタイプ設定
16. URLエンコード/デコード（日本語ファイル名対応）
17. XSSを防ぐHTML/URLエスケープ処理
18. Directory Traversal攻撃防止

## セキュリティ機能
19. ルートディレクトリ外へのアクセス禁止
20. 相対パス（..）による不正アクセス防止
21. アクセスログ表示（IP、タイムスタンプ、User-Agent）

## 対応形式
- **画像**: PNG, JPG, JPEG, GIF, BMP, WEBP
- **動画**: MP4, WebM, OGG, AVI, MOV, WMV, FLV, MKV, M4V
- **テキスト**: TXT, LOG, MD, RB, PY, JS, HTML, CSS, JSON, XML, YML, CSV等
- **エンコーディング**: UTF-8, Shift_JIS, EUC-JP, ISO-2022-JP, Windows-31J

## 起動方法
```bash
ruby file_manager.rb [ディレクトリ] [ポート番号]
# 例: ruby file_manager.rb /home/user/documents 8080
```

## 必須要件
- Ruby標準ライブラリのみ使用（gem不要）
- クロスプラットフォーム対応（Windows/Linux）
- 日本語ファイル名・ディレクトリ名完全対応
- エラーハンドリング完備
- Ctrl+Cでの安全な停止処理

ファイル名は `file_manager.rb` として、すべての機能を1つのファイルに実装してください。
```

## 追加プロンプト（段階的実装）

### ステップ1: 基本サーバー
```
まず基本的なHTTPサーバーとディレクトリ表示機能を実装してください。TCPServerを使用し、HTMLでファイル一覧を表示する機能まで。
```

### ステップ2: ファイル操作
```
アップロード、削除、名前変更機能を追加してください。multipart/form-dataパースとPOST処理を実装。
```

### ステップ3: ビューア機能
```
画像モーダル、テキストビューア、動画プレーヤーを追加してください。各ファイル種別の判定と適切な表示機能。
```

### ステップ4: 高度な機能
```
HTTP Range Request、日本語対応、セキュリティ強化を実装してください。
```

## カスタマイズプロンプト

### 認証機能追加
```
Basic認証機能を追加して、ユーザー名とパスワードでのアクセス制御を実装してください。
```

### HTTPS対応
```
OpenSSLを使用してHTTPS対応を追加してください。自己署名証明書の生成も含む。
```

### ファイルアップロード制限
```
アップロードファイルの種別制限（ホワイトリスト）とサイズ制限機能を追加してください。
```

## 注意事項

このプロンプトで生成されるファイルマネージャーは：
- 開発・テスト用途を想定
- セキュリティ機能が限定的
- 本番環境での使用は非推奨

## 生成後の確認ポイント

1. すべての機能が動作することを確認
2. セキュリティ設定の見直し
3. エラーハンドリングの検証
4. クロスプラットフォーム動作確認
5. 日本語ファイル名での動作確認
